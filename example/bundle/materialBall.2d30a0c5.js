var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a={},t={},n=e.parcelRequire5b70;null==n&&((n=function(e){if(e in a)return a[e].exports;if(e in t){var n=t[e];delete t[e];var r={id:e,exports:{}};return a[e]=r,n.call(r.exports,r,r.exports),r.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,a){t[e]=a},e.parcelRequire5b70=n);var r=n("ilwiq"),i=n("RPVlj"),o=n("7lx9d"),s=n("5Rd1x"),l=n("4CEV9"),d=n("cVdfP"),m=n("891vQ"),c=n("kp7Te"),u=n("jiuw3");let h,g,p,w,v,C,y,f;const b={material1:{color:"#ffc766",emissive:"#000000",emissiveIntensity:1,roughness:.1,metalness:.8,ior:1.495,transmission:0,opacity:1},material2:{color:"#db7157",emissive:"#000000",emissiveIntensity:1,roughness:.8,metalness:.1,transmission:0,ior:1.495,opacity:1},material3:{color:"#000000",roughness:.01,metalness:.05},stableNoise:!1,environmentIntensity:3,environmentRotation:0,bounces:5,samplesPerFrame:1,acesToneMapping:!0,resolutionScale:1/window.devicePixelRatio,transparentTraversals:20,filterGlossyFactor:.5,tiles:1};window.location.hash.includes("transmission")&&(b.material1.metalness=0,b.material1.roughness=.05,b.material1.transmission=1,b.material1.color="#ffffff",b.bounces=10);function M(){const e=window.innerWidth,a=window.innerHeight,t=b.resolutionScale,n=window.devicePixelRatio;w.target.setSize(e*t*n,a*t*n),w.reset(),h.setSize(e,a),h.setPixelRatio(window.devicePixelRatio*t),v.aspect=e/a,v.updateProjectionMatrix()}function x(){w.reset()}function R(){requestAnimationFrame(R);const e=y[0];e.color.set(b.material1.color).convertSRGBToLinear(),e.emissive.set(b.material1.emissive).convertSRGBToLinear(),e.emissiveIntensity=b.material1.emissiveIntensity,e.metalness=b.material1.metalness,e.roughness=b.material1.roughness,e.transmission=b.material1.transmission,e.ior=b.material1.ior,e.opacity=b.material1.opacity;const a=y[1];a.color.set(b.material2.color).convertSRGBToLinear(),a.emissive.set(b.material2.emissive).convertSRGBToLinear(),a.emissiveIntensity=b.material2.emissiveIntensity,a.metalness=b.material2.metalness,a.roughness=b.material2.roughness,a.transmission=b.material2.transmission,a.ior=b.material2.ior,a.opacity=b.material2.opacity;const t=y[2];t.color.set(b.material3.color).convertSRGBToLinear(),t.metalness=b.material3.metalness,t.roughness=b.material3.roughness,w.material.materials.updateFrom(p.materials,p.textures),w.material.filterGlossyFactor=b.filterGlossyFactor,w.material.environmentIntensity=b.environmentIntensity,w.material.environmentBlur=.35,w.material.bounces=b.bounces,w.material.physicalCamera.updateFrom(v),v.updateMatrixWorld();for(let e=0,a=b.samplesPerFrame;e<a;e++)w.update();h.autoClear=!1,C.render(h),h.autoClear=!0,f.innerText=`Samples: ${Math.floor(w.samples)}`}window.innerWidth/window.innerHeight<.65&&(b.bounces=Math.max(b.bounces,6),b.resolutionScale*=.5,b.tiles=2),async function(){h=new r.WebGLRenderer({antialias:!0}),h.toneMapping=r.ACESFilmicToneMapping,document.body.appendChild(h.domElement),v=new l.PhysicalCamera(75,window.innerWidth/window.innerHeight,.025,500),v.position.set(-4,2,3),w=new l.PathTracingRenderer(h),w.camera=v,w.material=new l.PhysicalPathTracingMaterial,w.material.setDefine("TRANSPARENT_TRAVERSALS",b.transparentTraversals),w.tiles.set(b.tiles,b.tiles),C=new i.FullScreenQuad(new r.MeshBasicMaterial({map:w.target.texture})),g=new s.OrbitControls(v,h.domElement),g.addEventListener("change",(()=>{w.reset()})),f=document.getElementById("samples");const e=new Promise((e=>{(new m.RGBELoader).load("https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/equirectangular/royal_esplanade_1k.hdr",(a=>{const t=new r.PMREMGenerator(h);t.compileCubemapShader();const n=t.fromEquirectangular(a);w.material.environmentMap=n.texture,e()}))})),a=new d.PathTracingSceneWorker,t=(new o.GLTFLoader).setMeshoptDecoder(c.MeshoptDecoder).loadAsync("https://raw.githubusercontent.com/gkjohnson/3d-demo-data/main/models/material-balls/material_ball_v2.glb").then((e=>{const t=new r.Group;e.scene.scale.setScalar(.01),e.scene.updateMatrixWorld(),t.add(e.scene);const n=new r.Box3;n.setFromObject(e.scene);const i=new r.Mesh(new r.CylinderBufferGeometry(3,3,.05,200),new r.MeshStandardMaterial({color:16777215,roughness:0,metalness:.25}));i.geometry=i.geometry.toNonIndexed(),i.geometry.clearGroups(),i.position.y=n.min.y-.03,t.add(i);const o=new r.MeshStandardMaterial,s=new r.MeshStandardMaterial;return e.scene.traverse((e=>{e.geometry&&e.geometry.computeVertexNormals(),"Sphere_1"===e.name?e.material=s:e.material=o,"subsphere_1"===e.name&&(e.material=s)})),y=[o,s,i.material],a.generate(t)})).then((e=>{p=e;const{bvh:t,textures:n,materials:r}=e,i=t.geometry,o=w.material;o.bvh.updateFrom(t),o.normalAttribute.updateFrom(i.attributes.normal),o.tangentAttribute.updateFrom(i.attributes.tangent),o.uvAttribute.updateFrom(i.attributes.uv),o.materialIndexAttribute.updateFrom(i.attributes.materialIndex),o.textures.setTextures(h,2048,2048,n),o.materials.updateFrom(r,n),o.setDefine("MATERIAL_LENGTH",r.length),a.dispose()}));await Promise.all([t,e]),document.getElementById("loading").remove(),M(),window.addEventListener("resize",M);const n=new u.GUI,T=n.addFolder("Path Tracing");T.add(b,"acesToneMapping").onChange((e=>{h.toneMapping=e?r.ACESFilmicToneMapping:r.NoToneMapping,C.material.needsUpdate=!0})),T.add(b,"stableNoise").onChange((e=>{w.stableNoise=e})),T.add(b,"tiles",1,4,1).onChange((e=>{w.tiles.set(e,e)})),T.add(b,"samplesPerFrame",1,10,1),T.add(b,"filterGlossyFactor",0,1).onChange((()=>{w.reset()})),T.add(b,"environmentIntensity",0,10).onChange((()=>{w.reset()})),T.add(b,"environmentRotation",0,40).onChange((e=>{w.material.environmentRotation.setFromMatrix4((new r.Matrix4).makeRotationY(e)),w.reset()})),T.add(b,"bounces",1,30,1).onChange((()=>{w.reset()})),T.add(b,"transparentTraversals",0,40,1).onChange((e=>{w.material.setDefine("TRANSPARENT_TRAVERSALS",e),w.reset()})),T.add(b,"resolutionScale",.1,1).onChange((()=>{M()}));const S=n.addFolder("Camera");S.add(v,"focusDistance",1,100).onChange(x),S.add(v,"apertureBlades",0,10,1).onChange((function(e){v.apertureBlades=0===e?0:Math.max(e,3),this.updateDisplay(),x()})),S.add(v,"apertureRotation",0,12.5).onChange(x),S.add(v,"anamorphicRatio",.1,10).onChange(x),S.add(v,"bokehSize",0,50).onChange(x).listen(),S.add(v,"fStop",.3,20).onChange(x).listen(),S.add(v,"fov",25,100).onChange((()=>{v.updateProjectionMatrix(),x()})).listen();const F=n.addFolder("Shell Material");F.addColor(b.material1,"color").onChange(x),F.addColor(b.material1,"emissive").onChange(x),F.add(b.material1,"emissiveIntensity",0,50,.01).onChange(x),F.add(b.material1,"roughness",0,1).onChange(x),F.add(b.material1,"metalness",0,1).onChange(x),F.add(b.material1,"opacity",0,1).onChange(x),F.add(b.material1,"transmission",0,1).onChange(x),F.add(b.material1,"ior",.9,3).onChange(x),F.close();const P=n.addFolder("Ball Material");P.addColor(b.material2,"color").onChange(x),P.addColor(b.material2,"emissive").onChange(x),P.add(b.material2,"emissiveIntensity",0,50,.01).onChange(x),P.add(b.material2,"roughness",0,1).onChange(x),P.add(b.material2,"metalness",0,1).onChange(x),P.add(b.material2,"opacity",0,1).onChange(x),P.add(b.material2,"transmission",0,1).onChange(x),P.add(b.material2,"ior",.9,3).onChange(x),P.close();const E=n.addFolder("Floor Material");E.addColor(b.material3,"color").onChange(x),E.add(b.material3,"roughness",0,1).onChange(x),E.add(b.material3,"metalness",0,1).onChange(x),E.close(),R()}();
//# sourceMappingURL=materialBall.2d30a0c5.js.map
